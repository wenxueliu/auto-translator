# 智能翻译插件

一款基于Chrome浏览器的智能翻译插件，支持词库管理和上下文感知翻译。

## 功能特点

- **智能双向翻译**: 支持中文到英文、英文到中文的智能翻译
  - 自动检测选中文本的语言类型
  - 根据语言自动切换翻译方向
- **右键菜单翻译**: 右键点击页面选择"翻译当前网页"
  - 选中文文时显示"翻译为英文"选项
  - 选中英文时显示"翻译选中文本"选项
- **词库管理**: 支持中英文词汇管理
  - 右键选中文文或英文单词，添加到个人词库
  - 自动识别语言类型并标记（中文/英文）
  - 支持单词和短语的添加
- **上下文感知翻译**: 结合上下文进行智能翻译，提供更准确的翻译结果
- **多模型支持**:
  - OpenAI: gpt-3.5-turbo, gpt-4, gpt-4-turbo
  - Anthropic: claude-3-haiku, claude-3-sonnet, claude-3-opus
  - Google: gemini-pro, gemini-1.5-flash, gemini-1.5-pro
  - DeepSeek: deepseek-chat
  - Qwen: qwen-mt-turbo, qwen-mt-plus（推荐，秒翻）
  - 支持自定义OpenAI兼容模型
- **拼音标注**: 中文词汇自动生成拼音标注（基础版）
- **词库导入导出**: 支持词库的备份和恢复
  - 导出为JSON格式文件
  - 导入并合并现有词库
  - 按语言筛选词库（全部/中文/英文）

## 安装方法

1. 下载项目文件
2. 打开Chrome浏览器，进入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹

## 配置

1. **推荐使用 qwen-mt-turbo**（翻译速度快，质量好）
   - 获取API Key: https://bailian.console.aliyun.com/?tab=api#/api/?type=model&url=2712195

2. **其他可选模型**：
   - **OpenAI系列**: 需要在 https://platform.openai.com 获取API Key
   - **Claude系列**: 需要在 https://console.anthropic.com 获取API Key
   - **Gemini系列**: 需要在 https://makersuite.google.com 获取API Key
   - **DeepSeek**: 需要在 https://platform.deepseek.com 获取API Key
   - **自定义模型**: 支持任何OpenAI兼容的API接口

## 使用指南

### 基本使用

#### 1. 翻译网页
- 在任意网页空白处右键点击，选择"翻译当前网页"
- 插件会自动翻译页面中已添加到词库的词汇

#### 2. 添加词汇到词库
**中文词汇**:
1. 选中页面上的中文文本
2. 右键选择"添加到词库"或"添加到词库并翻译"
3. 插件会自动识别为中文并添加拼音标注

**英文词汇**:
1. 选中页面上的英文文本
2. 右键选择"添加到词库"或"添加到词库并翻译"
3. 插件会自动识别为英文

**翻译选中文字**:
- 选中文文 → 右键选择"翻译为英文"
- 选中英文 → 右键选择"添加到词库并翻译"

### 配置API

1. 点击浏览器工具栏的插件图标打开设置页面
2. 在"API配置"部分：
   - 输入您的API Key
   - 选择翻译模型（推荐：qwen-mt-turbo）
   - 如果选择自定义模型，填写API地址和模型名称
3. 点击"保存API配置"

### 翻译设置

在"翻译设置"部分可以配置：
- **翻译方向**: 自动/中文到英文/英文到中文
- **上下文感知翻译**: 启用后会提供更准确的翻译
- **显示原文**: 翻译时是否保留原文
- **显示拼音**: 中文词汇是否显示拼音（词库显示）

### 词库管理

#### 查看词库
- 在设置页面可以查看所有已添加的词汇
- 词汇显示：
  - 词汇文本
  - 拼音（中文词汇）
  - 语言标签（中文/英文）
  - 类型标签（单词/短语）
  - 添加时间和词数

#### 筛选词库
- 按语言筛选：全部/中文/英文
- 自动统计各语言词汇数量

#### 导出词库
1. 点击"导出词库"按钮
2. 自动下载JSON格式文件
3. 文件名格式：`vocabulary_YYYY-MM-DD.json`
4. 用于备份或分享词库

#### 导入词库
1. 点击"导入词库"按钮
2. 选择之前导出的JSON文件
3. 插件会自动合并现有词库和导入的词库
4. 显示导入的词汇数量

#### 删除单词
- 点击词汇右侧的"删除"按钮即可删除

## 文件结构

```
translate-extension/
├── manifest.json          # 插件配置文件
├── background.js          # 后台脚本
├── content.js             # 内容脚本
├── popup.html             # 设置页面
├── popup.css              # 设置页面样式
├── popup.js               # 设置页面逻辑
├── styles.css             # 内容脚本样式
├── icons/
│   ├── icon16.png         # 16x16图标
│   ├── icon48.png         # 48x48图标
│   └── icon128.png        # 128x128图标
└── README.md              # 说明文档
```

## 技术实现

### 右键菜单
- 使用 `chrome.contextMenus` API 创建智能右键菜单
  - 自动检测选中文本的语言类型
  - 动态显示相应的翻译选项
  - 支持中文到英文、英文到中文的翻译

### 词库管理
- 使用 `chrome.storage.local` 存储词库数据
  - 支持中英文词汇的增删改查操作
  - 自动语言检测和分类
  - 提供导入导出功能
  - 支持单词和短语的区分

### 翻译功能
- 使用 `chrome.scripting.executeScript` 注入翻译脚本
  - 遍历DOM文本节点进行智能翻译
  - 支持上下文感知翻译
  - 双向翻译支持（中文↔英文）
  - 防止重复翻译

### 多模型API集成
- 统一的翻译服务接口
  - 支持多种AI模型（OpenAI、Claude、Gemini、DeepSeek、Qwen）
  - 模型特定的URL、Headers和Payload处理
  - 统一的错误处理和回退机制
  - 支持自定义OpenAI兼容模型

### 语言检测
- 基于正则表达式的语言检测
  - 中文字符检测：`/[\u4e00-\u9fff]/`
  - 英文字符检测：`/[a-zA-Z]+/`
  - 自动识别混合文本
  - 根据检测结果自动选择翻译方向

## 注意事项

1. **API Key安全**: 请妥善保管您的API Key，不要分享给他人或上传到公开仓库
2. **翻译限制**: 不同API提供商有不同的调用次数和费用限制
   - Qwen MT: 性价比高，速度快
   - OpenAI: 需要付费账户
   - Claude: 需要付费账户
   - Gemini: 有免费额度
3. **网络要求**: 需要网络连接才能使用在线翻译功能
4. **词库备份**: 建议定期导出词库进行备份
5. **中文拼音**: 当前拼音为基础版本，覆盖常用词汇

## 常见问题

**Q: 为什么右键菜单看不到"翻译为英文"选项？**
A: 只有选中中文文本时才会显示"翻译为英文"选项。选中英文文本时会显示"翻译选中文本"菜单。

**Q: 如何批量导入词汇？**
A: 准备一个JSON格式的文件，格式为`{"word": {"word": "原文", "language": "zh/en", ...}}`，然后在设置页面导入。

**Q: 翻译不准确怎么办？**
A: 可以启用"上下文感知翻译"选项，插件会结合周围文本进行更准确的翻译。

**Q: 支持哪些语言？**
A: 当前主要支持中文和英文的双向翻译。自动检测语言类型并选择合适的翻译方向。

**Q: 词库数据存储在哪里？**
A: 存储在浏览器的本地存储中（chrome.storage.local），不会上传到任何服务器（除了翻译API调用）。

## 更新日志

### v1.0.0
- ✅ 初始版本发布
- ✅ 支持中英文双向翻译
- ✅ 智能语言检测和菜单切换
- ✅ 词库管理（添加、删除、导入、导出）
- ✅ 上下文感知翻译
- ✅ 多模型支持（OpenAI、Claude、Gemini、DeepSeek、Qwen）
- ✅ 自定义模型支持
- ✅ 拼音标注（中文词汇）
- ✅ 语言筛选功能
- ✅ 单词和短语识别